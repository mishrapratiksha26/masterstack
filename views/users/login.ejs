<% layout('layouts/boilerplate') %>
<figure class="text-center">
    <h1 class="display-6" >Login</h1></figure>
<form action="/login" method="post" id="login-form" >
    <div class="mb-3">
        <label class="form-label" for="login-email">Email: </label>
            <input class="form-control" type="text" id="login-email"  required>
            <div class="valid-feedback">
                looks good!
               </div>
    </div>

    <div class="mb-3">
        <label class="form-label" for="login-password">password </label>
            <input class="form-control" type="text" id="login-password"  required>
            <div class="valid-feedback">
                looks good!
               </div>
    </div>
    <button class="btn btn-success">Login</button>
</form>
<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-storage.js"></script>
<script>
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
    apiKey: "AIzaSyCNLo42HAe2ISi-vx1hQY6gdlyz_xHLAHc",
    authDomain: "mastermart-22408.firebaseapp.com",
    projectId: "mastermart-22408",
    storageBucket: "mastermart-22408.appspot.com",
    messagingSenderId: "723072315665",
    appId: "1:723072315665:web:06a3b55e685dced8a7dcb0",
    measurementId: "G-HKV4D9WE2N"
  };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db2 = firebase.firestore();
    var storage = firebase.storage();
    db2.settings({ timeStampsInSnapshots: true });
</script>
<script>
const loginForm = document.querySelector('#login-form');
loginForm.addEventListener('submit', (e) => {
    e.preventDefault();
    //get user info
    const email = loginForm['login-email'].value;
    const password = loginForm['login-password'].value;
    auth.signInWithEmailAndPassword(email, password).then(cred => {
           console.log(cred.user);
           console.log('userloggedin')
        //close modal and reset
        const modal = document.querySelector('#modal-login');
        M.Modal.getInstance(modal).close();
        loginForm.reset();
    }); 
})
</script>